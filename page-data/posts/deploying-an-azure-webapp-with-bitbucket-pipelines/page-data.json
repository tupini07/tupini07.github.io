{"componentChunkName":"component---src-templates-post-template-tsx","path":"/posts/deploying-an-azure-webapp-with-bitbucket-pipelines","result":{"data":{"site":{"siteMetadata":{"title":"Personal Notebook","subtitle":"Personal notebook","copyright":"Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Un-ported License","author":{"name":"Andrea Tupini","twitter":""},"disqusShortname":"","url":"https://tupini07.github.io"}},"mdx":{"id":"9f7bc325-3f50-515f-a56e-1c861e334854","body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Deploying Azure webapp with Bitbucket pipelines\",\n  \"date\": \"2020-07-14T18:21:30.000+00:00\",\n  \"layout\": \"post\",\n  \"draft\": false,\n  \"path\": \"posts/deploying-an-azure-webapp-with-bitbucket-pipelines\",\n  \"category\": \"DevOps\",\n  \"description\": \"How to easily deploy an Azure WebApp from Bitbucket pipelines\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"Need to create a \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"principal\"), \" which has access to the webapp we want to deploy. To create a principal , first install the\\nAzure CLI, and run the following:\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"bash\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-bash\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"az ad sp create-for-rbac --name MyServicePrincipal\"))), mdx(\"p\", null, \"The principal has a role of \", mdx(\"code\", {\n    parentName: \"p\",\n    \"className\": \"language-text\"\n  }, \"Contributor\"), \" by default, so if you have access to the project then it is very likely that\\nthe principal will also have access. The roles of a principal can be easily changed via the cli. Note that this also\\nmeans that a single principal can be used to deploy different apps.\"), mdx(\"p\", null, \"The deployment can be made with the\\n\", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://bitbucket.org/microsoft/azure-web-apps-deploy/src/master/\"\n  }, \"microsoft/azure-web-apps-deploy\"), \" pipeline. We just\\nneed to provide it with the create principal's credentials and the app information where we want to deploy. Refer to the\\npipeline's page for more documentation.\"), mdx(\"p\", null, \"Once you already have the credentials for the principal you can login with the following command:\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"bash\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-bash\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"az login --service-principal --username \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token variable\"\n  }, \"${AZURE_APP_ID}\"), \" --password \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token variable\"\n  }, \"${AZURE_PASSWORD}\"), \" --tenant \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token variable\"\n  }, \"${AZURE_TENANT_ID}\")))), mdx(\"p\", null, \"At the time of this writing, the deployment can be tested locally with the following command.\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"bash\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-bash\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-bash\"\n  }, \"az webapp deployment \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token builtin class-name\"\n  }, \"source\"), \" config-zip --resource-group \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token variable\"\n  }, \"${AZURE_RESOURCE_GROUP}\"), \" --name \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token variable\"\n  }, \"${AZURE_APP_NAME}\"), \" --src \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token variable\"\n  }, \"${ZIP_FILE}\")))));\n}\n;\nMDXContent.isMDXComponent = true;","fields":{"tagSlugs":null,"slug":"posts/deploying-an-azure-webapp-with-bitbucket-pipelines"},"frontmatter":{"title":"Deploying Azure webapp with Bitbucket pipelines","tags":null,"date":"2020-07-14T18:21:30.000+00:00","description":"How to easily deploy an Azure WebApp from Bitbucket pipelines"}}},"pageContext":{"slug":"posts/deploying-an-azure-webapp-with-bitbucket-pipelines"}},"staticQueryHashes":["1512840792","876543683"]}